import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.dvv-DFtf.js";const d=JSON.parse('{"title":"ğŸ”¥ MULTI-TENANT INBOX CLASSIFIER - IntegraÃ§Ã£o Completa","description":"","frontmatter":{},"headers":[],"relativePath":"arquitetura/MULTI_TENANT_INTEGRATION.md","filePath":"arquitetura/MULTI_TENANT_INTEGRATION.md"}'),e={name:"arquitetura/MULTI_TENANT_INTEGRATION.md"};function t(p,s,h,k,r,o){return n(),a("div",null,[...s[0]||(s[0]=[l(`<h1 id="ğŸ”¥-multi-tenant-inbox-classifier-integracao-completa" tabindex="-1">ğŸ”¥ MULTI-TENANT INBOX CLASSIFIER - IntegraÃ§Ã£o Completa <a class="header-anchor" href="#ğŸ”¥-multi-tenant-inbox-classifier-integracao-completa" aria-label="Permalink to &quot;ğŸ”¥ MULTI-TENANT INBOX CLASSIFIER - IntegraÃ§Ã£o Completa&quot;">â€‹</a></h1><h2 id="ğŸ“‹-visao-geral" tabindex="-1">ğŸ“‹ VisÃ£o Geral <a class="header-anchor" href="#ğŸ“‹-visao-geral" aria-label="Permalink to &quot;ğŸ“‹ VisÃ£o Geral&quot;">â€‹</a></h2><p>Sistema multi-tenant de classificaÃ§Ã£o de leads com IA que integra com o Self-Improving AI System.</p><p><strong>BenefÃ­cios:</strong></p><ul><li>âœ… Cada cliente tem ICP/Persona prÃ³prio</li><li>âœ… Versionamento de personas (histÃ³rico + A/B test)</li><li>âœ… Whitelist de conhecidos por tenant</li><li>âœ… ClassificaÃ§Ã£o personalizada por IA</li><li>âœ… Tracking de conversÃµes e ROI</li><li>âœ… Auto-melhoria baseada em feedback</li></ul><hr><h2 id="ğŸ—ï¸-arquitetura" tabindex="-1">ğŸ—ï¸ Arquitetura <a class="header-anchor" href="#ğŸ—ï¸-arquitetura" aria-label="Permalink to &quot;ğŸ—ï¸ Arquitetura&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚                  MULTI-TENANT ARCHITECTURE                   â”‚</span></span>
<span class="line"><span>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚  Tenant A (Socialfy)          Tenant B (FitPro)            â”‚</span></span>
<span class="line"><span>â”‚  â”œâ”€â”€ Persona V1               â”œâ”€â”€ Persona V2                â”‚</span></span>
<span class="line"><span>â”‚  â”œâ”€â”€ Whitelist (10)           â”œâ”€â”€ Whitelist (5)             â”‚</span></span>
<span class="line"><span>â”‚  â”œâ”€â”€ 500 leads/mÃªs            â”œâ”€â”€ 200 leads/mÃªs             â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€ Score mÃ©dio: 65          â””â”€â”€ Score mÃ©dio: 72           â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚                       â†“                                     â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚              INBOX CLASSIFIER (Python)                      â”‚</span></span>
<span class="line"><span>â”‚              â”œâ”€â”€ Scrape Instagram                           â”‚</span></span>
<span class="line"><span>â”‚              â”œâ”€â”€ Check Whitelist                            â”‚</span></span>
<span class="line"><span>â”‚              â”œâ”€â”€ Classify with AI (personalizada)           â”‚</span></span>
<span class="line"><span>â”‚              â””â”€â”€ Save to Supabase                           â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚                       â†“                                     â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚              SUPABASE (Multi-Tenant DB)                     â”‚</span></span>
<span class="line"><span>â”‚              â”œâ”€â”€ tenants                                    â”‚</span></span>
<span class="line"><span>â”‚              â”œâ”€â”€ tenant_personas (versionado)               â”‚</span></span>
<span class="line"><span>â”‚              â”œâ”€â”€ tenant_known_contacts                      â”‚</span></span>
<span class="line"><span>â”‚              â””â”€â”€ classified_leads                           â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚                       â†“                                     â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â”‚         SELF-IMPROVING SYSTEM (Camadas 1-4)                 â”‚</span></span>
<span class="line"><span>â”‚         â”œâ”€â”€ QA Analyst (avalia classificaÃ§Ãµes)              â”‚</span></span>
<span class="line"><span>â”‚         â”œâ”€â”€ Reflection Loop (otimiza personas)              â”‚</span></span>
<span class="line"><span>â”‚         â”œâ”€â”€ Prompt Improver (atualiza prompts IA)           â”‚</span></span>
<span class="line"><span>â”‚         â””â”€â”€ A/B Test (compara versÃµes)                      â”‚</span></span>
<span class="line"><span>â”‚                                                             â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span></code></pre></div><hr><h2 id="ğŸ“Š-schema-do-banco-migration-005" tabindex="-1">ğŸ“Š Schema do Banco (Migration 005) <a class="header-anchor" href="#ğŸ“Š-schema-do-banco-migration-005" aria-label="Permalink to &quot;ğŸ“Š Schema do Banco (Migration 005)&quot;">â€‹</a></h2><h3 id="tabelas-criadas" tabindex="-1">Tabelas Criadas: <a class="header-anchor" href="#tabelas-criadas" aria-label="Permalink to &quot;Tabelas Criadas:&quot;">â€‹</a></h3><ol><li><p><strong><code>tenants</code></strong> - Clientes do SaaS</p><ul><li><code>id</code>, <code>name</code>, <code>slug</code>, <code>status</code>, <code>plan_tier</code></li><li>Limits: <code>max_leads_per_month</code>, <code>max_auto_responses_per_day</code></li></ul></li><li><p><strong><code>tenant_personas</code></strong> - ICP versionado</p><ul><li><code>tenant_id</code>, <code>version</code>, <code>is_active</code></li><li>Business context: <code>business_type</code>, <code>target_audience</code>, <code>product_service</code></li><li>ICP: <code>ideal_niches</code>, <code>min_followers</code>, <code>positive_keywords</code></li><li>Versionamento: histÃ³rico completo de mudanÃ§as</li></ul></li><li><p><strong><code>tenant_known_contacts</code></strong> - Whitelist</p><ul><li><code>tenant_id</code>, <code>username</code>, <code>contact_type</code></li><li><code>auto_classify_as</code>, <code>skip_ai_analysis</code></li></ul></li><li><p><strong><code>classified_leads</code></strong> - Leads classificados</p><ul><li><code>tenant_id</code>, <code>persona_version</code> (qual versÃ£o foi usada)</li><li><code>profile_data</code> (JSONB): bio, followers, posts</li><li><code>ai_analysis</code> (JSONB): reasoning, keywords, signals</li><li><code>classification</code>: LEAD_HOT, LEAD_WARM, LEAD_COLD, PESSOAL, SPAM</li><li><code>icp_score</code>: 0-100</li></ul></li></ol><h3 id="views-criadas" tabindex="-1">Views Criadas: <a class="header-anchor" href="#views-criadas" aria-label="Permalink to &quot;Views Criadas:&quot;">â€‹</a></h3><ul><li><strong><code>vw_tenant_performance</code></strong>: Performance por tenant (30 dias)</li><li><strong><code>vw_lead_classification_stats</code></strong>: EstatÃ­sticas de classificaÃ§Ã£o</li></ul><h3 id="functions-rpc" tabindex="-1">Functions RPC: <a class="header-anchor" href="#functions-rpc" aria-label="Permalink to &quot;Functions RPC:&quot;">â€‹</a></h3><ul><li><strong><code>get_active_persona(tenant_id)</code></strong>: Busca persona ativa</li><li><strong><code>is_known_contact(tenant_id, platform, username)</code></strong>: Checa whitelist</li><li><strong><code>save_classified_lead(...)</code></strong>: Salva lead classificado</li></ul><hr><h2 id="ğŸ”§-como-usar" tabindex="-1">ğŸ”§ Como Usar <a class="header-anchor" href="#ğŸ”§-como-usar" aria-label="Permalink to &quot;ğŸ”§ Como Usar&quot;">â€‹</a></h2><h3 id="_1-executar-migration" tabindex="-1">1. Executar Migration <a class="header-anchor" href="#_1-executar-migration" aria-label="Permalink to &quot;1. Executar Migration&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># No Supabase SQL Editor</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrations/005_multi_tenant_inbox_classifier.sql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pbcopy</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cole no SQL Editor e execute</span></span></code></pre></div><h3 id="_2-configurar-tenant" tabindex="-1">2. Configurar Tenant <a class="header-anchor" href="#_2-configurar-tenant" aria-label="Permalink to &quot;2. Configurar Tenant&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Criar novo tenant</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenants (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, slug, business_type, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, plan_tier)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;Sua Empresa&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;sua-empresa&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;AgÃªncia de Marketing&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;active&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;pro&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Criar persona V1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenant_personas (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tenant_id,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  is_active,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  business_type,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  target_audience,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  product_service,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  value_proposition,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ideal_niches,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  positive_keywords,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  negative_keywords,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  min_followers,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  max_followers,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  brand_voice,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  message_style</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenants </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> slug </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;sua-empresa&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  true,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;AgÃªncia de AutomaÃ§Ã£o&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;Donos de agÃªncia que precisam de leads&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;AutomaÃ§Ã£o de prospecÃ§Ã£o com IA&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;Gere 10-30 leads/mÃªs no automÃ¡tico&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ARRAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[&#39;marketing&#39;, &#39;vendas&#39;, &#39;agÃªncias&#39;],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ARRAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[&#39;agÃªncia&#39;, &#39;leads&#39;, &#39;automaÃ§Ã£o&#39;, &#39;clientes&#39;],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ARRAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[&#39;personal&#39;, &#39;fitness&#39;, &#39;afiliado&#39;],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  50000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;profissional&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;direto ao ponto&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Adicionar contatos conhecidos (whitelist)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenant_known_contacts (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tenant_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  platform,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  username,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  contact_type,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  auto_classify_as,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  skip_ai_analysis</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenants </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> slug </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;sua-empresa&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;instagram&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;seuamigo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;amigo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;PESSOAL&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, true),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenants </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> slug </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;sua-empresa&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;instagram&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;seusocio&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;socio&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;PESSOAL&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, true);</span></span></code></pre></div><h3 id="_3-usar-python-classifier" tabindex="-1">3. Usar Python Classifier <a class="header-anchor" href="#_3-usar-python-classifier" aria-label="Permalink to &quot;3. Usar Python Classifier&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inbox_classifier_multi_tenant </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> InboxClassifierMultiTenant</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Inicializar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> InboxClassifierMultiTenant(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tenant_slug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sua-empresa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classifier.initialize()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Classificar mensagem</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classification, lead_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classifier.classify_inbox_message(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    username</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;joao_agencia&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Adorei seu conteÃºdo sobre automaÃ§Ã£o!&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ClassificaÃ§Ã£o: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classification.classification</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Score: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classification.icp_score</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Resposta sugerida: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classification.suggested_response</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_4-workflow-n8n-automacao" tabindex="-1">4. Workflow n8n (AutomaÃ§Ã£o) <a class="header-anchor" href="#_4-workflow-n8n-automacao" aria-label="Permalink to &quot;4. Workflow n8n (AutomaÃ§Ã£o)&quot;">â€‹</a></h3><p><strong>Trigger:</strong> Nova mensagem no inbox Instagram (via webhook GoHighLevel)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Webhook</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>[Check Whitelist]</span></span>
<span class="line"><span>  â”œâ”€ Conhecido? â†’ Responder como pessoal</span></span>
<span class="line"><span>  â””â”€ Desconhecido â†’ Continuar</span></span>
<span class="line"><span>       â†“</span></span>
<span class="line"><span>[Scrape Profile] (Instagram API ou Gemini)</span></span>
<span class="line"><span>       â†“</span></span>
<span class="line"><span>[Classify with AI] (Python function)</span></span>
<span class="line"><span>       â†“</span></span>
<span class="line"><span>[Save to Supabase]</span></span>
<span class="line"><span>       â†“</span></span>
<span class="line"><span>[Decision Based on Score]</span></span>
<span class="line"><span>  â”œâ”€ LEAD_HOT (80-100) â†’ Auto-respond + CRM + Notificar</span></span>
<span class="line"><span>  â”œâ”€ LEAD_WARM (50-79) â†’ Auto-respond + Nurturing</span></span>
<span class="line"><span>  â”œâ”€ LEAD_COLD (20-49) â†’ Nurturing educativo</span></span>
<span class="line"><span>  â””â”€ SPAM (0-19) â†’ Archive</span></span></code></pre></div><hr><h2 id="ğŸ”„-versionamento-de-personas" tabindex="-1">ğŸ”„ Versionamento de Personas <a class="header-anchor" href="#ğŸ”„-versionamento-de-personas" aria-label="Permalink to &quot;ğŸ”„ Versionamento de Personas&quot;">â€‹</a></h2><h3 id="por-que-versionar" tabindex="-1">Por que versionar? <a class="header-anchor" href="#por-que-versionar" aria-label="Permalink to &quot;Por que versionar?&quot;">â€‹</a></h3><p>Quando um cliente muda o ICP:</p><ul><li><strong>V1:</strong> &quot;Quero personal trainers&quot;</li><li><strong>V2:</strong> &quot;Agora quero donos de academia&quot;</li></ul><p>BenefÃ­cios:</p><ul><li>âœ… HistÃ³rico preservado (pode re-classificar leads antigos)</li><li>âœ… Comparar conversÃ£o V1 vs V2</li><li>âœ… Rollback se V2 performar pior</li><li>âœ… A/B test de personas</li></ul><h3 id="como-criar-nova-versao" tabindex="-1">Como criar nova versÃ£o: <a class="header-anchor" href="#como-criar-nova-versao" aria-label="Permalink to &quot;Como criar nova versÃ£o:&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Obter Ãºltima versÃ£o</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenant_personas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenant_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Criar V2 (desativa V1 automaticamente via trigger)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenant_personas (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tenant_id,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  is_active,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ... campos atualizados ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Nova versÃ£o</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  true,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ... novos valores de ICP ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="comparar-performance-v1-vs-v2" tabindex="-1">Comparar performance V1 vs V2: <a class="header-anchor" href="#comparar-performance-v1-vs-v2" aria-label="Permalink to &quot;Comparar performance V1 vs V2:&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  persona_version,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_leads,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(icp_score) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg_score,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classification </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;LEAD_HOT&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ELSE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hot_leads,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> converted_to_opportunity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">THEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ELSE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conversions</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classified_leads</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tenant_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xxx&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> persona_version;</span></span></code></pre></div><hr><h2 id="ğŸ“ˆ-integracao-com-self-improving" tabindex="-1">ğŸ“ˆ IntegraÃ§Ã£o com Self-Improving <a class="header-anchor" href="#ğŸ“ˆ-integracao-com-self-improving" aria-label="Permalink to &quot;ğŸ“ˆ IntegraÃ§Ã£o com Self-Improving&quot;">â€‹</a></h2><p>O Multi-Tenant Inbox Classifier se integra com o Self-Improving System:</p><h3 id="_1-qa-analyst-avalia-classificacoes" tabindex="-1">1. QA Analyst avalia classificaÃ§Ãµes <a class="header-anchor" href="#_1-qa-analyst-avalia-classificacoes" aria-label="Permalink to &quot;1. QA Analyst avalia classificaÃ§Ãµes&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Conversas do inbox viram agent_conversations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> agent_conversations (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  agent_version_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  contact_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  channel,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  outcome,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mensagens_total,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  qa_analyzed</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> agent_versions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> agent_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Inbox Classifier&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  cl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  cl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">platform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  CASE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    WHEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">classification</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;LEAD_HOT&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;scheduled&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    WHEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">classification</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;LEAD_WARM&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;warmed&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ELSE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;in_progress&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  false  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- SerÃ¡ analisado pelo QA Analyst</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classified_leads cl</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tenant_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h3 id="_2-reflection-loop-otimiza-persona" tabindex="-1">2. Reflection Loop otimiza persona <a class="header-anchor" href="#_2-reflection-loop-otimiza-persona" aria-label="Permalink to &quot;2. Reflection Loop otimiza persona&quot;">â€‹</a></h3><p>O Reflection Loop pode:</p><ul><li>Analisar leads classificados</li><li>Identificar falsos positivos/negativos</li><li>Sugerir ajustes na persona (keywords, ranges)</li><li>Auto-aplicar melhorias</li></ul><h3 id="_3-prompt-improver-atualiza-ia" tabindex="-1">3. Prompt Improver atualiza IA <a class="header-anchor" href="#_3-prompt-improver-atualiza-ia" aria-label="Permalink to &quot;3. Prompt Improver atualiza IA&quot;">â€‹</a></h3><p>Se score mÃ©dio cai:</p><ul><li>Gera nova versÃ£o da persona</li><li>Atualiza keywords</li><li>Testa em batch de leads antigos</li><li>Compara performance</li></ul><hr><h2 id="ğŸ“Š-dashboard-proximo-passo" tabindex="-1">ğŸ“Š Dashboard (PrÃ³ximo passo) <a class="header-anchor" href="#ğŸ“Š-dashboard-proximo-passo" aria-label="Permalink to &quot;ğŸ“Š Dashboard (PrÃ³ximo passo)&quot;">â€‹</a></h2><h3 id="metricas-por-tenant" tabindex="-1">MÃ©tricas por Tenant: <a class="header-anchor" href="#metricas-por-tenant" aria-label="Permalink to &quot;MÃ©tricas por Tenant:&quot;">â€‹</a></h3><ul><li>Total de leads (30d)</li><li>Taxa de HOT/WARM/COLD</li><li>Score ICP mÃ©dio</li><li>Taxa de conversÃ£o</li><li>Custo por lead</li><li>ROI</li></ul><h3 id="por-persona" tabindex="-1">Por Persona: <a class="header-anchor" href="#por-persona" aria-label="Permalink to &quot;Por Persona:&quot;">â€‹</a></h3><ul><li>Performance V1 vs V2 vs V3</li><li>Keywords mais efetivas</li><li>Score breakdown</li><li>SugestÃµes de otimizaÃ§Ã£o</li></ul><h3 id="acoes" tabindex="-1">AÃ§Ãµes: <a class="header-anchor" href="#acoes" aria-label="Permalink to &quot;AÃ§Ãµes:&quot;">â€‹</a></h3><ul><li>Editar persona</li><li>Criar nova versÃ£o</li><li>Rollback para versÃ£o anterior</li><li>A/B test automÃ¡tico</li></ul><hr><h2 id="ğŸš€-proximos-passos" tabindex="-1">ğŸš€ PrÃ³ximos Passos <a class="header-anchor" href="#ğŸš€-proximos-passos" aria-label="Permalink to &quot;ğŸš€ PrÃ³ximos Passos&quot;">â€‹</a></h2><ol><li><strong>Executar migration 005</strong> âœ…</li><li><strong>Testar Python classifier</strong></li><li><strong>Criar workflow n8n</strong></li><li><strong>Integrar com GoHighLevel inbox</strong></li><li><strong>Criar dashboard de configuraÃ§Ã£o</strong></li><li><strong>Implementar auto-resposta</strong></li><li><strong>Conectar com Self-Improving System</strong></li></ol><hr><h2 id="ğŸ’¡-exemplo-real-socialfy" tabindex="-1">ğŸ’¡ Exemplo Real: Socialfy <a class="header-anchor" href="#ğŸ’¡-exemplo-real-socialfy" aria-label="Permalink to &quot;ğŸ’¡ Exemplo Real: Socialfy&quot;">â€‹</a></h2><h3 id="persona-v1-janeiro" tabindex="-1">Persona V1 (Janeiro): <a class="header-anchor" href="#persona-v1-janeiro" aria-label="Permalink to &quot;Persona V1 (Janeiro):&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;target_audience&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Donos de agÃªncia de marketing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;ideal_niches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;marketing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vendas&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tech&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;positive_keywords&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;agÃªncia&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;clientes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;leads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;min_followers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;max_followers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Resultados:</strong></p><ul><li>500 leads classificados</li><li>120 LEAD_HOT</li><li>Taxa conversÃ£o: 18%</li><li>Score mÃ©dio: 65</li></ul><h3 id="persona-v2-marco" tabindex="-1">Persona V2 (MarÃ§o): <a class="header-anchor" href="#persona-v2-marco" aria-label="Permalink to &quot;Persona V2 (MarÃ§o):&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;target_audience&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Donos de agÃªncia + consultores&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;ideal_niches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;marketing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vendas&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tech&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;consultoria&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;positive_keywords&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;agÃªncia&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;consultoria&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;clientes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;leads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ROI&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;min_followers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Reduziu</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;max_followers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Aumentou</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Resultados:</strong></p><ul><li>800 leads classificados (â†‘60%)</li><li>200 LEAD_HOT (â†‘67%)</li><li>Taxa conversÃ£o: 22% (â†‘4pp)</li><li>Score mÃ©dio: 72 (â†‘7)</li></ul><p><strong>DecisÃ£o:</strong> Manter V2, desativar V1</p><hr><h2 id="ğŸ“-notas-importantes" tabindex="-1">ğŸ“ Notas Importantes <a class="header-anchor" href="#ğŸ“-notas-importantes" aria-label="Permalink to &quot;ğŸ“ Notas Importantes&quot;">â€‹</a></h2><ol><li><strong>Privacidade:</strong> Dados de cada tenant sÃ£o isolados (tenant_id em todas as queries)</li><li><strong>Rate Limiting:</strong> Instagram scraping tem limites (2-3 seg entre requests)</li><li><strong>Custos:</strong> Gemini Flash Ã© barato (~$0.0001 por classificaÃ§Ã£o)</li><li><strong>Qualidade:</strong> Score ICP calibrado para cada negÃ³cio</li><li><strong>Escalabilidade:</strong> Suporta 1000+ tenants sem mudanÃ§a de cÃ³digo</li></ol><hr><p><strong>Autor:</strong> AI Factory V4 - MOTTIVME <strong>Data:</strong> 31/12/2025 <strong>VersÃ£o:</strong> 1.0.0</p>`,76)])])}const c=i(e,[["render",t]]);export{d as __pageData,c as default};
