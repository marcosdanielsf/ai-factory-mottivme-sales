import{_ as a,c as n,o as s,ag as e}from"./chunks/framework.dvv-DFtf.js";const u=JSON.parse('{"title":"Pipeline de Voz","description":"","frontmatter":{},"headers":[],"relativePath":"arquitetura/cold-call-bot/pipeline.md","filePath":"arquitetura/cold-call-bot/pipeline.md"}'),d={name:"arquitetura/cold-call-bot/pipeline.md"};function p(l,t,r,i,o,c){return s(),n("div",null,[...t[0]||(t[0]=[e(`<h1 id="pipeline-de-voz" tabindex="-1">Pipeline de Voz <a class="header-anchor" href="#pipeline-de-voz" aria-label="Permalink to &quot;Pipeline de Voz&quot;">​</a></h1><h2 id="fluxo-de-audio" tabindex="-1">Fluxo de Áudio <a class="header-anchor" href="#fluxo-de-audio" aria-label="Permalink to &quot;Fluxo de Áudio&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Telefone (PSTN 8kHz)</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>┌─────────────────────┐</span></span>
<span class="line"><span>│  Telnyx/Twilio SIP   │</span></span>
<span class="line"><span>│  WebSocket Stream     │</span></span>
<span class="line"><span>└──────────┬──────────┘</span></span>
<span class="line"><span>           │ μ-law → PCM</span></span>
<span class="line"><span>           ▼</span></span>
<span class="line"><span>┌─────────────────────┐</span></span>
<span class="line"><span>│  Deepgram STT        │</span></span>
<span class="line"><span>│  Nova-3 (PT-BR)      │</span></span>
<span class="line"><span>│  endpointing: 500ms  │</span></span>
<span class="line"><span>└──────────┬──────────┘</span></span>
<span class="line"><span>           │ texto</span></span>
<span class="line"><span>           ▼</span></span>
<span class="line"><span>┌─────────────────────┐</span></span>
<span class="line"><span>│  SmartTurn V3        │</span></span>
<span class="line"><span>│  stop: 2.5s          │</span></span>
<span class="line"><span>│  pre_speech: 500ms   │</span></span>
<span class="line"><span>└──────────┬──────────┘</span></span>
<span class="line"><span>           │</span></span>
<span class="line"><span>           ▼</span></span>
<span class="line"><span>┌─────────────────────┐</span></span>
<span class="line"><span>│  OpenAI gpt-4o-mini  │</span></span>
<span class="line"><span>│  + GHL Function Call  │</span></span>
<span class="line"><span>│  (6 tools)           │</span></span>
<span class="line"><span>└──────────┬──────────┘</span></span>
<span class="line"><span>           │ texto resposta</span></span>
<span class="line"><span>           ▼</span></span>
<span class="line"><span>┌─────────────────────┐</span></span>
<span class="line"><span>│  Cartesia TTS        │</span></span>
<span class="line"><span>│  Sonic-3 (Luana)     │</span></span>
<span class="line"><span>│  + flush_audio fix   │</span></span>
<span class="line"><span>└──────────┬──────────┘</span></span>
<span class="line"><span>           │ PCM → μ-law</span></span>
<span class="line"><span>           ▼</span></span>
<span class="line"><span>┌─────────────────────┐</span></span>
<span class="line"><span>│  Telnyx/Twilio SIP   │</span></span>
<span class="line"><span>│  WebSocket Stream     │</span></span>
<span class="line"><span>└──────────┬──────────┘</span></span>
<span class="line"><span>           │</span></span>
<span class="line"><span>           ▼</span></span>
<span class="line"><span>     Telefone Lead</span></span></code></pre></div><h2 id="supabase-schema" tabindex="-1">Supabase Schema <a class="header-anchor" href="#supabase-schema" aria-label="Permalink to &quot;Supabase Schema&quot;">​</a></h2><h3 id="cold-call-logs" tabindex="-1">cold_call_logs <a class="header-anchor" href="#cold-call-logs" aria-label="Permalink to &quot;cold_call_logs&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Coluna</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>id</td><td>uuid</td><td>PK</td></tr><tr><td>call_id</td><td>text</td><td>ID da chamada (Twilio/Telnyx)</td></tr><tr><td>phone</td><td>text</td><td>Telefone do lead</td></tr><tr><td>lead_name</td><td>text</td><td>Nome do lead</td></tr><tr><td>status</td><td>text</td><td>completed, failed, etc</td></tr><tr><td>outcome</td><td>text</td><td>agendou, interessado, nao_atendeu, recusou</td></tr><tr><td>duration_seconds</td><td>numeric(10,2)</td><td>Duração em segundos</td></tr><tr><td>transcript</td><td>text</td><td>Transcrição completa</td></tr><tr><td>cost_usd</td><td>numeric(8,4)</td><td>Custo total USD</td></tr><tr><td>cost_breakdown</td><td>jsonb</td><td>Breakdown por componente</td></tr><tr><td>started_at</td><td>timestamptz</td><td>Início da chamada</td></tr></tbody></table><h3 id="cold-call-retry-queue" tabindex="-1">cold_call_retry_queue <a class="header-anchor" href="#cold-call-retry-queue" aria-label="Permalink to &quot;cold_call_retry_queue&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Coluna</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>id</td><td>uuid</td><td>PK</td></tr><tr><td>phone</td><td>text</td><td>Telefone</td></tr><tr><td>attempt_number</td><td>int</td><td>Tentativa atual</td></tr><tr><td>max_attempts</td><td>int</td><td>Máximo configurável (1-6)</td></tr><tr><td>next_retry_at</td><td>timestamptz</td><td>Próximo retry (business hours)</td></tr><tr><td>status</td><td>text</td><td>pending, paused, calling, completed, cancelled</td></tr></tbody></table><h3 id="custos-por-chamada-0-04-min" tabindex="-1">Custos por Chamada (~$0.04/min) <a class="header-anchor" href="#custos-por-chamada-0-04-min" aria-label="Permalink to &quot;Custos por Chamada (~$0.04/min)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Componente</th><th>Custo/min</th><th>% Total</th></tr></thead><tbody><tr><td>Telephony</td><td>$0.045</td><td>56%</td></tr><tr><td>TTS</td><td>$0.018</td><td>22%</td></tr><tr><td>STT</td><td>$0.005</td><td>6%</td></tr><tr><td>LLM</td><td>$0.002</td><td>3%</td></tr></tbody></table><h2 id="endpoints-api" tabindex="-1">Endpoints API <a class="header-anchor" href="#endpoints-api" aria-label="Permalink to &quot;Endpoints API&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Método</th><th>Endpoint</th><th>Descrição</th></tr></thead><tbody><tr><td>GET</td><td>/health</td><td>Health check</td></tr><tr><td>GET</td><td>/costs/summary?days=30</td><td>Custos agregados</td></tr><tr><td>GET</td><td>/calls/active</td><td>Chamadas ativas</td></tr><tr><td>GET</td><td>/retry/queue</td><td>Fila de retries</td></tr><tr><td>POST</td><td>/retry/now</td><td>Retry imediato</td></tr><tr><td>POST</td><td>/retry/cancel</td><td>Cancelar retry</td></tr><tr><td>POST</td><td>/retry/settings</td><td>Toggle auto-retry + max_attempts</td></tr><tr><td>POST</td><td>/retry/process</td><td>Processar fila (cron)</td></tr><tr><td>POST</td><td>/outbound-call</td><td>Iniciar chamada</td></tr></tbody></table>`,12)])])}const m=a(d,[["render",p]]);export{u as __pageData,m as default};
